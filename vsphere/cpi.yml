---
- type: replace
  path: /releases/-
  value:
    name: bosh-vsphere-cpi
    version: 38
    url: https://bosh.io/d/github.com/cloudfoundry-incubator/bosh-vsphere-cpi-release?v=38
    sha1: cd964bb1858d6533efb1192b00afac76e80cb602

- type: replace
  path: /resource_pools/name=vms/stemcell?
  value:
    url: https://bosh.io/d/stemcells/bosh-vsphere-esxi-ubuntu-trusty-go_agent?v=3312.15
    sha1: 60b8230da19d7e27b5101fc34f569e85eb5b3ad0

# Configure sizes
- type: replace
  path: /resource_pools/name=vms/cloud_properties?
  value:
    cpu: 2
    ram: 4_096
    disk: 20_000

- type: replace
  path: /networks/name=default/subnets/0/cloud_properties?
  value: {name: ((network_name))}

# Add CPI job
- type: replace
  path: /instance_groups/name=bosh/jobs/-
  value: &cpi_job
    name: vsphere_cpi
    release: bosh-vsphere-cpi

- type: replace
  path: /instance_groups/name=bosh/properties/director/cpi_job?
  value: vsphere_cpi

- type: replace
  path: /cloud_provider/template?
  value: *cpi_job

- type: replace
  path: /instance_groups/name=bosh/properties/vcenter?
  value: &vcenter
    address: ((vcenter_ip))
    user: ((vcenter_user))
    password: ((vcenter_password))
    datacenters:
    - name: ((vcenter_dc))
      vm_folder: ((vcenter_vm_folder))
      template_folder: ((vcenter_templates_folder))
      datastore_pattern: ((vcenter_ds_ephemeral))
      persistent_datastore_pattern: ((vcenter_ds_persistent))
      disk_path: ((vcenter_disk_path))
      clusters: ((vcenter_cluster))

- type: replace
  path: /cloud_provider/properties/vcenter?
  value: *vcenter

- type: replace
  path: /cloud_provider/properties/vcenter/datacenters/0/clusters?
  value: ((vcenter_bosh_director_cluster))

- type: replace
  path: /cloud_provider/properties/vcenter/datacenters/0/datastore_pattern?
  value: ((vcenter_ds_persistent))

